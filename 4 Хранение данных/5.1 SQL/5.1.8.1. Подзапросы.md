
Подзапрос (subquery) - это запрос, который вложен в другой запрос (главный запрос). Он используется для получения дополнительных данных, которые могут быть использованы в условиях, фильтрации, агрегировании или других операциях в главном запросе. Сначала выполняется подзапрос, потом выполняется главный запрос.


**Типы подзапросов:**
- **Вложенные подзапросы (Nested subqueries):** Подзапросы, которые вложены в другой запрос.
```sql
SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM orders WHERE order_date > '2023-03-01');

```

- **Коррелированные подзапросы (Correlated subqueries):** Подзапрос зависит от данных главного запроса, поэтому он выполняется многократно для каждой строки главного запроса. Это может свести к снижению производительности запроса, особенно если таблицы большие.

**`employees`** (Сотрудники): `employee_id`, `employee_name`, `department_id`
**`departments`** (Отделы): `department_id`, `department_name`

**Задача:** Найти всех сотрудников, у которых зарплата выше средней зарплаты в их отделе.

**Решение с коррелированным подзапросом:**

```sql
SELECT e.employee_id, e.employee_name, e.department_id
FROM employees e
WHERE e.salary > (
    SELECT AVG(salary) 
    FROM employees 
    WHERE department_id = e.department_id
);
```
